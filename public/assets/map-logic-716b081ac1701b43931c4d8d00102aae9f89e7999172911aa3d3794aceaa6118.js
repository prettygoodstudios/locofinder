mapboxgl.accessToken="pk.eyJ1IjoicHJldHR5Z29vZHN0dWRpb3MiLCJhIjoiY2pkamx4aTZlMWt4dDJwbnF5a3ZmbTEzcyJ9.lu_9eqO1kmUMPf9LXU80yg";var map=new mapboxgl.Map({container:"map",style:"mapbox://styles/prettygoodstudios/cjdjnyk9047qy2rmm28tmk0m8"}),nav=new mapboxgl.NavigationControl;map.addControl(nav,"top-left"),$(document).on("turbolinks:load",function(){console.log("Hello World!"),fetch(ROOT_URL+"geo_json_api").then(function(o){return o.json()}).then(function(o){for(var e=0;e<o.length;e++){var t=document.createElement("div");t.className="marker";var a=new mapboxgl.Marker(t,{offset:[0,-35]}).setLngLat([o[e].coordinates[1],o[e].coordinates[0]]).addTo(map),n="<h3>"+o[e].title+"</h3>",r="<p>"+o[e].address+"</p>",i="<p>Average Rating: "+o[e].average_score+"</p>";0==o[e].average_score&&(i="");var l="<image class='popup-image' src='"+o[e].img_url+"'></image>";if(o[e].offsetX&&o[e].offsetY){var s=.5*o[e].zoom,p=o[e].offsetX*s,g=o[e].offsetY*s,m=o[e].width*s,c=o[e].height*s;l="<image class='popup-image' src='"+o[e].img_url+"' style='margin-left:"+p+"px; margin-top:"+g+"px; width: "+m+"px; height: "+c+"px;'></image>"}var d=o[e].img_url?"<div style='width: "+(o[e].offsetX?200:300)+"px; height: 200px; overflow: hidden; margin: auto auto 20px auto;'>"+l+"</div>":"",f="<a href='"+ROOT_URL+o[e].url+"' class='button' data-turbolinks='false'>More Info</a>",u=(new mapboxgl.Popup).setHTML(n+r+i+d.toString()+f);a.setPopup(u)}fetch("https://geoip-db.com/json/").then(function(o){return o.json()}).then(function(o){console.log("Hello World 2"),console.log(o),map.flyTo({center:[o.longitude,o.latitude],zoom:9})})["catch"](function(o){console.log("Error Fetching Coordinates",o)})})});